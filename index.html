 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/pos_system.html b/pos_system.html
index 573e23c4323ebd9cdf945eb08529827ce6c83ecf..a37b5fe65f065d658beafb443f1be52f447fda90 100644
--- a/pos_system.html
+++ b/pos_system.html
@@ -357,75 +357,84 @@
             .tab-content {
                 padding: 20px;
             }
 
             .cart-item {
                 flex-direction: column;
                 text-align: center;
             }
 
             .grid-2, .grid-3 {
                 grid-template-columns: 1fr;
             }
         }
 
         .scanner-container {
             text-align: center;
             padding: 20px;
             background: rgba(59,130,246,0.1);
             border-radius: 10px;
             margin: 20px 0;
         }
 
         .hidden {
             display: none !important;
         }
+
+        .last-save {
+            text-align: center;
+            margin: 20px 0;
+            color: #fff;
+        }
     </style>
 </head>
 <body>
     <div class="container">
         <div class="header">
             <h1>üè™ POS System</h1>
             <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∏‡∏î‡∏Ç‡∏≤‡∏¢‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏° PWA ‡πÅ‡∏•‡∏∞ Google Sheets</p>
         </div>
 
         <div class="nav-tabs">
             <div class="nav-tab active" onclick="showTab('sell')">üí∞ ‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
             <div class="nav-tab" onclick="showTab('stock-in')">‚ûï ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
             <div class="nav-tab" onclick="showTab('inventory')">üì¶ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á</div>
             <div class="nav-tab" onclick="showTab('reports')">üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</div>
             <div class="nav-tab" onclick="showTab('settings')">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</div>
         </div>
 
         <!-- ‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
         <div id="sell" class="tab-content active">
             <div class="grid grid-2">
                 <div class="card">
                     <h3>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                     <div class="form-group">
                         <label>‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î / ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
-                        <input type="text" id="searchProduct" class="form-control" placeholder="‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">
+                        <div style="display: flex; gap: 5px;">
+                            <input type="text" id="searchProduct" class="form-control" placeholder="‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">
+                            <button type="button" class="btn btn-success" onclick="startBarcodeScanner()">üì∑</button>
+                        </div>
                     </div>
                     <div class="form-group">
                         <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                         <select id="productSelect" class="form-control">
                             <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ --</option>
                         </select>
                     </div>
                     <div class="form-group">
                         <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label>
                         <input type="number" id="sellQuantity" class="form-control" value="1" min="1">
                     </div>
                     <button class="btn btn-success" onclick="addToCart()">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
                 </div>
 
                 <div class="card">
                     <h3>üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                     <div id="cartItems"></div>
                     <div class="stats-card">
                         <div class="stats-number" id="cartTotal">‡∏ø 0</div>
                         <div>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</div>
                     </div>
                     <div class="form-group">
                         <label>‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</label>
                         <input type="number" id="receivedAmount" class="form-control" placeholder="0">
                     </div>
diff --git a/pos_system.html b/pos_system.html
index 573e23c4323ebd9cdf945eb08529827ce6c83ecf..a37b5fe65f065d658beafb443f1be52f447fda90 100644
--- a/pos_system.html
+++ b/pos_system.html
@@ -591,50 +600,52 @@
                     <h3>üì± LINE Notify</h3>
                     <div class="form-group">
                         <label>LINE Token</label>
                         <input type="text" id="lineToken" class="form-control" placeholder="LINE Notify Token">
                     </div>
                     <div class="form-group">
                         <label>
                             <input type="checkbox" id="autoNotify"> ‡∏™‡πà‡∏á‡∏¢‡∏≠‡∏î‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
                         </label>
                     </div>
                     <button class="btn btn-success" onclick="testLineNotify()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö LINE</button>
                 </div>
 
                 <div class="card">
                     <h3>üö® ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
                     <div class="form-group">
                         <label>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (‡∏ä‡∏¥‡πâ‡∏ô)</label>
                         <input type="number" id="defaultMinStock" class="form-control" value="5" min="0">
                     </div>
                     <button class="btn btn-primary" onclick="saveSettings()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
                 </div>
             </div>
         </div>
     </div>
 
+    <div id="lastSaved" class="last-save"></div>
+
     <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ -->
     <div id="invoiceModal" class="modal">
         <div class="modal-content">
             <span class="close" onclick="closeInvoiceModal()">&times;</span>
             <div id="invoiceContent"></div>
             <div class="qr-container">
                 <div id="qrCode"></div>
                 <p>‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
             </div>
             <button class="btn btn-primary" onclick="downloadInvoice()">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</button>
         </div>
     </div>
 
     <!-- QR Code Library -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
     
     <!-- html2canvas for invoice download -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
 
     <script>
         // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á (‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö Google Sheets)
         let inventory = JSON.parse(localStorage.getItem('pos_inventory') || '[]');
         let sales = JSON.parse(localStorage.getItem('pos_sales') || '[]');
         let cart = [];
         let settings = JSON.parse(localStorage.getItem('pos_settings') || '{}');
diff --git a/pos_system.html b/pos_system.html
index 573e23c4323ebd9cdf945eb08529827ce6c83ecf..a37b5fe65f065d658beafb443f1be52f447fda90 100644
--- a/pos_system.html
+++ b/pos_system.html
@@ -772,126 +783,150 @@
         // ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
         function clearCart() {
             cart = [];
             updateCartDisplay();
             document.getElementById('receivedAmount').value = '';
             document.getElementById('changeAmount').value = '';
         }
 
         // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô
         function calculateChange() {
             const received = parseFloat(document.getElementById('receivedAmount').value) || 0;
             const total = cart.reduce((sum, item) => sum + (item.sellPrice * item.quantity), 0);
             const change = received - total;
             
             document.getElementById('changeAmount').value = change >= 0 ? change.toFixed(2) : '';
         }
 
         document.getElementById('receivedAmount').addEventListener('input', calculateChange);
 
         // ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢
         function processSale() {
             if (cart.length === 0) {
                 alert('‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á');
                 return;
             }
-            
-            const received = parseFloat(document.getElementById('receivedAmount').value) || 0;
+
+            const receivedField = document.getElementById('receivedAmount');
+            const receivedStr = receivedField.value.trim();
             const total = cart.reduce((sum, item) => sum + (item.sellPrice * item.quantity), 0);
-            
+
+            if (receivedStr === '') {
+                const sale = {
+                    id: Date.now(),
+                    date: new Date().toISOString(),
+                    items: [...cart],
+                    total: total,
+                    received: 0,
+                    change: total,
+                    profit: cart.reduce((sum, item) => sum + ((item.sellPrice - item.costPrice) * item.quantity), 0)
+                };
+                showInvoice(sale);
+                return;
+            }
+
+            const received = parseFloat(receivedStr) || 0;
+
             if (received < total) {
                 alert('‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠');
                 return;
             }
-            
+
             // ‡∏•‡∏î‡∏™‡∏ï‡πä‡∏≠‡∏Å
             cart.forEach(cartItem => {
                 inventory[cartItem.productIndex].quantity -= cartItem.quantity;
             });
-            
+
             // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢
             const sale = {
                 id: Date.now(),
                 date: new Date().toISOString(),
                 items: [...cart],
                 total: total,
                 received: received,
                 change: received - total,
                 profit: cart.reduce((sum, item) => sum + ((item.sellPrice - item.costPrice) * item.quantity), 0)
             };
-            
+
             sales.push(sale);
-            
+
             // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
             localStorage.setItem('pos_inventory', JSON.stringify(inventory));
             localStorage.setItem('pos_sales', JSON.stringify(sales));
-            
+
             // ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤
             showInvoice(sale);
-            
+
             // ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
             clearCart();
             loadProductsForSell(); // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
         }
 
         // ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤
         function showInvoice(sale) {
             const modal = document.getElementById('invoiceModal');
             const invoiceContent = document.getElementById('invoiceContent');
             const storeName = settings.storeName || '‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô';
-            
+
             let itemsHtml = '';
             sale.items.forEach(item => {
                 const itemTotal = item.sellPrice * item.quantity;
                 itemsHtml += `
                     <div class="invoice-item">
                         <span>${item.name} √ó ${item.quantity}</span>
                         <span>‡∏ø${itemTotal.toLocaleString()}</span>
                     </div>
                 `;
             });
-            
+
+            const paymentHtml = sale.received < sale.total
+                ? `<div class="invoice-item">
+                        <span>‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞</span>
+                        <span>‡∏ø${(sale.total - sale.received).toLocaleString()}</span>
+                   </div>`
+                : `<div class="invoice-item">
+                        <span>‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</span>
+                        <span>‡∏ø${sale.received.toLocaleString()}</span>
+                   </div>
+                   <div class="invoice-item">
+                        <span>‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô</span>
+                        <span>‡∏ø${sale.change.toLocaleString()}</span>
+                   </div>`;
+
             invoiceContent.innerHTML = `
                 <div class="invoice">
                     <div class="invoice-header">
                         <h2>${storeName}</h2>
-                        <p>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ #${sale.id}</p>
+                        <p>${sale.received < sale.total ? '‡πÉ‡∏ö PR' : '‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤'} #${sale.id}</p>
                         <p>${new Date(sale.date).toLocaleString('th-TH')}</p>
                     </div>
                     ${itemsHtml}
                     <div class="invoice-item invoice-total">
                         <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span>
                         <span>‡∏ø${sale.total.toLocaleString()}</span>
                     </div>
-                    <div class="invoice-item">
-                        <span>‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</span>
-                        <span>‡∏ø${sale.received.toLocaleString()}</span>
-                    </div>
-                    <div class="invoice-item">
-                        <span>‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô</span>
-                        <span>‡∏ø${sale.change.toLocaleString()}</span>
-                    </div>
+                    ${paymentHtml}
                 </div>
             `;
             
             // ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code PromptPay
             generatePromptPayQR(sale.total);
             
             modal.style.display = 'block';
         }
 
         // ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code PromptPay
         function generatePromptPayQR(amount) {
             const promptPayId = settings.promptPayId || '0812345678';
             const qr = new QRious({
                 element: document.getElementById('qrCode'),
                 value: generatePromptPayString(promptPayId, amount),
                 size: 200
             });
         }
 
         // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏ï‡∏£‡∏¥‡∏á PromptPay
         function generatePromptPayString(id, amount) {
             // ‡∏™‡∏£‡πâ‡∏≤‡∏á PromptPay QR ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏ò‡∏õ‡∏ó.
             let qrString = '00020101021129370016A000000677010111';
             qrString += '0013' + id.padStart(13, '0');
             qrString += '5802TH';
diff --git a/pos_system.html b/pos_system.html
index 573e23c4323ebd9cdf945eb08529827ce6c83ecf..a37b5fe65f065d658beafb443f1be52f447fda90 100644
--- a/pos_system.html
+++ b/pos_system.html
@@ -1213,58 +1248,72 @@
             reportResults.innerHTML = `
                 <div class="card">
                     <h4>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢${periodText[period]}</h4>
                     <div class="grid grid-3">
                         <div class="stats-card">
                             <div class="stats-number">‡∏ø ${totalRevenue.toLocaleString()}</div>
                             <div>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°</div>
                         </div>
                         <div class="stats-card">
                             <div class="stats-number">‡∏ø ${totalProfit.toLocaleString()}</div>
                             <div>‡∏Å‡∏≥‡πÑ‡∏£‡∏£‡∏ß‡∏°</div>
                         </div>
                         <div class="stats-card">
                             <div class="stats-number">${totalOrders}</div>
                             <div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</div>
                         </div>
                     </div>
                     
                     <h5>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h5>
                     ${filteredSales.map(sale => `
                         <div class="card">
                             <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${new Date(sale.date).toLocaleString('th-TH')}</p>
                             <p><strong>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:</strong> ${sale.items.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
                             <p><strong>‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢:</strong> ‡∏ø${sale.total.toLocaleString()}</p>
                             <p><strong>‡∏Å‡∏≥‡πÑ‡∏£:</strong> ‡∏ø${sale.profit.toLocaleString()}</p>
+                            <button class="btn btn-danger" onclick="confirmDeleteSale(${sale.id})">‡∏•‡∏ö</button>
                         </div>
                     `).join('')}
                 </div>
             `;
         }
 
+        function confirmDeleteSale(id) {
+            const input = prompt('‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô (DDMM):');
+            const now = new Date();
+            const code = now.getDate().toString().padStart(2, '0') + (now.getMonth() + 1).toString().padStart(2, '0');
+            if (input === code) {
+                sales = sales.filter(s => s.id !== id);
+                localStorage.setItem('pos_sales', JSON.stringify(sales));
+                generateReport();
+            } else {
+                alert('‡∏£‡∏´‡∏±‡∏™‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
+            }
+        }
+
         // === LINE Notify ===
-        
+
         function sendLineNotify() {
             if (!settings.lineToken) {
                 alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Token ‡∏Å‡πà‡∏≠‡∏ô');
                 return;
             }
             
             const today = new Date();
             const todayStr = today.toISOString().split('T')[0];
             const todaySales = sales.filter(sale => 
                 sale.date.split('T')[0] === todayStr
             );
             
             const todayRevenue = todaySales.reduce((sum, sale) => sum + sale.total, 0);
             const todayProfit = todaySales.reduce((sum, sale) => sum + sale.profit, 0);
             const todayOrders = todaySales.length;
             
             const message = `
 üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
 üè™ ‡∏£‡πâ‡∏≤‡∏ô: ${settings.storeName || '‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô'}
 üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${today.toLocaleDateString('th-TH')}
 
 üí∞ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ: ‡∏ø${todayRevenue.toLocaleString()}
 üìà ‡∏Å‡∏≥‡πÑ‡∏£: ‡∏ø${todayProfit.toLocaleString()}
 üõí ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: ${todayOrders}
 
diff --git a/pos_system.html b/pos_system.html
index 573e23c4323ebd9cdf945eb08529827ce6c83ecf..a37b5fe65f065d658beafb443f1be52f447fda90 100644
--- a/pos_system.html
+++ b/pos_system.html
@@ -1432,85 +1481,100 @@ ${itemList}
                         dateAdded: new Date().toISOString()
                     },
                     {
                         id: 3,
                         barcode: '8851019321456',
                         name: '‡∏Å‡∏≤‡πÅ‡∏ü‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á',
                         sellPrice: 35,
                         costPrice: 25,
                         quantity: 3, // ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î
                         minStock: 5,
                         dateAdded: new Date().toISOString()
                     }
                 ];
                 
                 localStorage.setItem('pos_inventory', JSON.stringify(inventory));
                 console.log('Sample data loaded');
             }
         }
 
         // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
         loadSampleData();
 
         // === Camera Scanner (Optional Enhancement) ===
         
         let cameraStream = null;
-        
+
         function startBarcodeScanner() {
-            if (!navigator.mediaDevices) {
-                alert('‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á');
+            if (!navigator.mediaDevices || !('BarcodeDetector' in window)) {
+                alert('‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á');
                 return;
             }
-            
+
             const scannerContainer = document.createElement('div');
             scannerContainer.className = 'scanner-container';
             scannerContainer.innerHTML = `
                 <h4>üì∑ ‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î</h4>
                 <video id="scannerVideo" width="300" height="200" autoplay></video>
                 <br>
                 <button class="btn btn-danger" onclick="stopBarcodeScanner()">‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πÅ‡∏Å‡∏ô</button>
             `;
-            
+
             document.querySelector('.tab-content.active').appendChild(scannerContainer);
-            
-            navigator.mediaDevices.getUserMedia({ 
-                video: { 
-                    facingMode: 'environment' // ‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á
-                } 
+
+            navigator.mediaDevices.getUserMedia({
+                video: {
+                    facingMode: 'environment'
+                }
             })
             .then(stream => {
                 cameraStream = stream;
-                document.getElementById('scannerVideo').srcObject = stream;
-                
-                // ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô (‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ library ‡∏≠‡∏¢‡πà‡∏≤‡∏á QuaggaJS)
-                setTimeout(() => {
-                    const mockBarcode = '8850006111101'; // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á
-                    document.getElementById('searchProduct').value = mockBarcode;
-                    document.getElementById('searchProduct').dispatchEvent(new Event('input'));
-                    stopBarcodeScanner();
-                    alert('‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + mockBarcode);
-                }, 3000);
+                const video = document.getElementById('scannerVideo');
+                video.srcObject = stream;
+
+                const detector = new BarcodeDetector({formats: ['code_128', 'ean_13', 'ean_8']});
+
+                const scanLoop = () => {
+                    detector.detect(video)
+                    .then(barcodes => {
+                        if (barcodes.length > 0) {
+                            const code = barcodes[0].rawValue;
+                            document.getElementById('searchProduct').value = code;
+                            document.getElementById('searchProduct').dispatchEvent(new Event('input'));
+                            stopBarcodeScanner();
+                            alert('‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ' + code);
+                            return;
+                        }
+                        requestAnimationFrame(scanLoop);
+                    })
+                    .catch(err => {
+                        console.error('Detect error:', err);
+                        requestAnimationFrame(scanLoop);
+                    });
+                };
+
+                requestAnimationFrame(scanLoop);
             })
             .catch(error => {
                 console.error('Camera access denied:', error);
                 alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ');
             });
         }
         
         function stopBarcodeScanner() {
             if (cameraStream) {
                 cameraStream.getTracks().forEach(track => track.stop());
                 cameraStream = null;
             }
             
             const scannerContainer = document.querySelector('.scanner-container');
             if (scannerContainer) {
                 scannerContainer.remove();
             }
         }
 
         // === PWA Install Prompt ===
         
         let deferredPrompt;
         
         window.addEventListener('beforeinstallprompt', (e) => {
             e.preventDefault();
diff --git a/pos_system.html b/pos_system.html
index 573e23c4323ebd9cdf945eb08529827ce6c83ecf..a37b5fe65f065d658beafb443f1be52f447fda90 100644
--- a/pos_system.html
+++ b/pos_system.html
@@ -1657,100 +1721,112 @@ ${itemList}
                     <button class="btn btn-primary" onclick="exportData()">üì§ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                     <input type="file" id="importFile" accept=".json" onchange="importData(event)" style="display: none;">
                     <button class="btn btn-warning" onclick="document.getElementById('importFile').click()">üì• ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                 </div>
                 <div class="form-group">
                     <button class="btn btn-success" onclick="startBarcodeScanner()">üì∑ ‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå</button>
                 </div>
             `;
             
             settingsTab.appendChild(exportImportCard);
         });
 
         // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
         document.addEventListener('DOMContentLoaded', function() {
             initializeSystem();
             
             // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
             const firstTime = localStorage.getItem('pos_first_time');
             if (!firstTime) {
                 setTimeout(() => {
                     alert(`
 üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö POS!
 
 ‚å®Ô∏è ‡∏Ñ‡∏µ‡∏¢‡πå‡∏•‡∏±‡∏î:
 F1 = ‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
-F2 = ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤  
+F2 = ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
 F3 = ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏á‡∏Ñ‡∏•‡∏±‡∏á
 F4 = ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
 
 üí° ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö "‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"
                     `);
                     localStorage.setItem('pos_first_time', 'true');
                 }, 1000);
             }
+
+            updateLastSaveDisplay();
         });
 
         // === Offline Support ===
         
         window.addEventListener('online', function() {
             console.log('‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÅ‡∏•‡πâ‡∏ß - ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
             syncWithGoogleSheets();
             
             // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
             const notification = document.createElement('div');
             notification.className = 'alert alert-success';
             notification.textContent = 'üü¢ ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡πÅ‡∏•‡πâ‡∏ß';
             notification.style.position = 'fixed';
             notification.style.top = '20px';
             notification.style.right = '20px';
             notification.style.zIndex = '1000';
             
             document.body.appendChild(notification);
             setTimeout(() => notification.remove(), 3000);
         });
         
         window.addEventListener('offline', function() {
             console.log('‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô Local Storage');
-            
+
             const notification = document.createElement('div');
             notification.className = 'alert alert-warning';
             notification.textContent = 'üü° ‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå - ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á';
             notification.style.position = 'fixed';
             notification.style.top = '20px';
             notification.style.right = '20px';
             notification.style.zIndex = '1000';
-            
+
             document.body.appendChild(notification);
             setTimeout(() => notification.remove(), 3000);
         });
 
         // === Auto-save ===
-        
+
         // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
+        function updateLastSaveDisplay() {
+            const last = localStorage.getItem('pos_last_save');
+            const el = document.getElementById('lastSaved');
+            if (el) {
+                el.textContent = last ? `üïí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${new Date(last).toLocaleString()}` : '';
+            }
+        }
+
         function autoSave() {
             localStorage.setItem('pos_inventory', JSON.stringify(inventory));
             localStorage.setItem('pos_sales', JSON.stringify(sales));
             localStorage.setItem('pos_settings', JSON.stringify(settings));
-            localStorage.setItem('pos_last_save', new Date().toISOString());
+            const now = new Date().toISOString();
+            localStorage.setItem('pos_last_save', now);
+            updateLastSaveDisplay();
         }
 
         // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å autoSave ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
         const originalAddStock = addStock;
         const originalProcessSale = processSale;
         
         addStock = function() {
             originalAddStock();
             autoSave();
         };
         
         processSale = function() {
             originalProcessSale();
             autoSave();
         };
 
         console.log('üè™ POS System ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
         console.log('üìä ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö:', inventory.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
         console.log('üí∞ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢:', sales.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
     </script>
 </body>
-</html>
+</html>
 
EOF
)
